{"data":{"markdownRemark":{"html":"<h2 id=\"tutorials-for-deploying-on-different-static-site-hosts\"><a href=\"#tutorials-for-deploying-on-different-static-site-hosts\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tutorials for deploying on different static site hosts</h2>\n<ul>\n<li><a href=\"/docs/deploy-gatsby/#amazon-s3-and-cloudfront\">S3/Cloudfront</a></li>\n<li><a href=\"/docs/deploy-gatsby/#github-pages\">GitHub Pages</a></li>\n<li><a href=\"/docs/deploy-gatsby/#gitlab-pages\">GitLab Pages</a></li>\n<li><a href=\"/docs/deploy-gatsby/#heroku\">Heroku</a></li>\n</ul>\n<h2 id=\"amazon-s3-and-cloudfront\"><a href=\"#amazon-s3-and-cloudfront\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Amazon S3 and Cloudfront</h2>\n<p>If you decide to host your Gatsby site on S3 with Cloudfront as CDN, you should\nchange the “Origin Domain Name” on the Cloudfront panel with the real URL of\nyour S3 bucket: <strong>examplewebsite.com.s3-website-eu-west-1.amazonaws.com</strong>\nreplacing the default URL suggested by Amazon\n<strong>examplewebsite.com.s3.amazonaws.com</strong>.</p>\n<p>Without this change,\n<a href=\"https://forums.aws.amazon.com/message.jspa?messageID=314454\">S3 doesn’t look for index.html files when serving “clean urls”</a>.</p>\n<h2 id=\"github-pages\"><a href=\"#github-pages\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>GitHub Pages</h2>\n<h3 id=\"deploying-a-project-page\"><a href=\"#deploying-a-project-page\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deploying a project page</h3>\n<p>You can deploy sites on GitHub Pages with or without a custom domain. If you\nchoose to use the default setup (without a custom domain), or if you create a\nproject site, you will need to setup your site with\n<a href=\"/docs/path-prefix/\">path prefixing</a>.</p>\n<p>On Github, you get one site per GitHub account and organization, and unlimited\nproject sites. So it is most likely you will be creating a project site. If you\ndo not have an existing repository on Github that you plan to use, take the time\nnow to create a new repository on Github.</p>\n<h3 id=\"use-the-npm-package-gh-pages-for-deploying\"><a href=\"#use-the-npm-package-gh-pages-for-deploying\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Use the NPM package <code>gh-pages</code> for deploying</h3>\n<p>First add <strong>gh-pages</strong> as a <code>devDependency</code> of your site and create an npm\nscript to <strong>deploy</strong> your project by running <code>npm install gh-pages --save-dev</code>\nor <code>yarn add gh-pages --dev</code> (if you have yarn installed).</p>\n<p>Then add a <code>deploy</code> script in your <code>package.json</code> file.</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>\"scripts\": {\n  \"deploy\": \"gatsby build --prefix-paths && gh-pages -d public\",\n}</code></pre>\n      </div>\n<p>In the <code>gatsby-config.js</code>, set the <code>pathPrefix</code> to be added to your site’s link\npaths. The <code>pathPrefix</code> should be the project name in your repository. (ex.\n<code>https://github.com/username/project-name</code> - your <code>pathPrefix</code> should be\n<code>/project-name</code>). See\n<a href=\"/docs/path-prefix/\">the docs page on path prefixing for more</a>.</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>module.exports = {\n  pathPrefix: `/project-name`,\n}</code></pre>\n      </div>\n<p>If you have not yet initialized a git repository in your working gatsby site\nrepo, set up git in your project with <code>git init</code>. Then tell Gatsby where to\ndeploy your site by adding the git remote address with https or ssh. Here is how\nto do it with https: <code>git remote add origin git@github.com:username/project-name.git</code>.</p>\n<p>Now run <code>yarn deploy</code> or <code>npm run deploy</code>. Preview changes in your GitHub page\n<code>https://username.github.io/project-name/</code>. You can also find the link to your\nsite on GitHub under <code>Settings</code> > <code>GitHub Pages</code>.</p>\n<h3 id=\"deploying-a-userorganization-site\"><a href=\"#deploying-a-userorganization-site\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deploying a user/organization site</h3>\n<p>Unlike project pages, user/organization sites on GitHub live in a special\nrepository dedicated to files for the site. The sites must be published from the\n<code>master</code> branch of the repository which means the site source files should be\nkept in a branch named <code>source</code> or something similar. We also don’t need to\nprefix links like we do with project sites.</p>\n<p>The repository for these sites requires a special name. See\n<a href=\"https://help.github.com/articles/user-organization-and-project-pages/\">https://help.github.com/articles/user-organization-and-project-pages/</a> for\ndocumentation on naming your site’s repository.</p>\n<p>If you wish to link your custom domain with your <code>user.github.io</code> repo, you will need\na <code>CNAME</code> file inside the <code>static</code> folder at the root directory level with the your\ncustom domain url inside, like so:</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>your-custom-domain.com</code></pre>\n      </div>\n<h2 id=\"gitlab-pages\"><a href=\"#gitlab-pages\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gitlab Pages</h2>\n<p>Gitlab Pages are similar to GitHub pages, perhaps even easier to setup. It also\nsupports custom domain names and SSL certificates. The process of setting GitLab\npages up is made a lot easier with GitLab’s included continuous integration\nplatform.</p>\n<p>Create a new GitLab repository, initialize your Gatsby project folder if you\nhaven’t already, and add the GitLab remote.</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>git init\ngit remote add origin git@gitlab.com:examplerepository\ngit add .\ngit push -u origin master</code></pre>\n      </div>\n<p>To use GitLab’s continuous integration (CI), you need to add a <code>.gitlab-ci.yml</code>\nconfiguration file. This can be added into your project folder, or once you have\npushed the repository, you can add it with GitLab’s website. The file needs to\ncontain a few required fields:</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>image: node:latest\n\n# This folder is cached between builds\n# http://docs.gitlab.com/ce/ci/yaml/README.html#cache\ncache:\n  paths:\n  - node_modules/\n\npages:\n  script:\n  - yarn install\n  - ./node_modules/.bin/gatsby build\n  artifacts:\n    paths:\n    - public\n  only:\n  - master</code></pre>\n      </div>\n<p>The CI platform uses Docker images/containers, so <code>image: node:latest</code> tells the\nCI to use the latest node image. <code>cache:</code> caches the <code>node_modules</code> folder\nin between builds, so subsequent builds should be a lot faster as it doesn’t have\nto reinstall all the dependancies required. <code>pages:</code> is the name of the\nCI stage. You can have multiple stages, e.g. ‘Test’, ‘Build’, ‘Deploy’ etc.\n<code>script:</code> starts the next part of the CI stage, telling it to start running the\nbelow scripts inside the image selected. We have used the <code>yarn install</code> and\n<code>./node_modules/.bin/gatsby build</code> which will install all dependancies, and\nstart the static site build, respectively. We have used\n<code>./node_modules/.bin/gatsby build</code> because we then don’t have to install\ngatsby-cli to build the image, as it has already been included and installed\nwith <code>yarn install</code>. <code>artifacts:</code> and <code>paths:</code> are used to tell GitLab pages\nwhere the static files are kept. <code>only:</code> and <code>master</code> tells the CI to only run\nthe above instructions when the master branch is deployed.</p>\n<p>Add that configuration, and with the next master branch push, your site should\nhave been built correctly. This can be checked by going to your repository on\nGitLab, and selecting CI/CD in the sidebar. This will then show you a log of all\njobs that have either succeeded or failed. You can click on the failed status,\nand then select the job to get more information about why your build may have\nfailed.</p>\n<p>If all went well, you should now be able to access your site. It will be hosted\nunder gitlab.io - for example if you have have a repository under your\nnamespace, the url will be yourname.gitlab.io/examplerepository.</p>\n<p>Visit the\n<a href=\"https://gitlab.com/help/user/project/pages/getting_started_part_one.md\">GitLab Pages</a>\nto learn how to setup custom domains and find out about advanced configurations.</p>\n<h2 id=\"heroku\"><a href=\"#heroku\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Heroku</h2>\n<p>You can use the <a href=\"https://github.com/heroku/heroku-buildpack-static\">heroku buildpack static</a> to handle the static files of your site.</p>\n<p>Set the <code>heroku/node.js</code> and <code>heroku-buildpack-static</code> buildpacks on your application creating an <code>app.json</code> file on the root of your project.</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>{\n  \"buildpacks\": [\n    {\n      \"url\": \"heroku/nodejs\"\n    },\n    {\n      \"url\": \"https://github.com/heroku/heroku-buildpack-static\"\n    }\n  ]\n}</code></pre>\n      </div>\n<p>Sometimes specifying buildpacks via the <code>app.json</code> file doesn’t work. If this is your case try to add them in the Heroku dashboard or via the CLI.</p>\n<p>Add a <code>heroku-postbuild</code> script in your <code>package.json</code>:</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>{\n\n  // ...\n  \"scripts\": {\n    // ...\n    \"heroku-postbuild\": \"gatsby build\"\n    // ...\n  }\n  // ...\n}</code></pre>\n      </div>\n<p>Finally, add a <code>static.json</code> file in the root of your project to define the directory where your static assets will be. You can check all the options for this file in the <a href=\"https://github.com/heroku/heroku-buildpack-static#configuration\">heroku-buildpack-static configuration</a>.</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>{\n  \"root\": \"public/\"\n}</code></pre>\n      </div>\n<h2 id=\"debugging-tips\"><a href=\"#debugging-tips\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Debugging tips</h2>\n<h3 id=\"dont-minify-html\"><a href=\"#dont-minify-html\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Don’t minify HTML</h3>\n<p>If you see the following error:</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>Unable to find element with ID ##</code></pre>\n      </div>\n<p>or alternatively</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>Uncaught Error: Minified React error #32; visit http://facebook.github.io/react/docs/error-decoder.html?invariant=32&args[]=## for the full message or use the non-minified dev environment for full errors and additional helpful warnings.</code></pre>\n      </div>\n<p>This is a new problem when dealing with static sites built with React. This is\nnot caused by Gatsby. React uses HTML comments to help identify locations of\ncomponents that do not render anything. If you are using a CDN that minifies\nyour HTML, it will eliminate the HTML comments used by React to take control of\nthe page on the client. Cloudflare is a CDN that minifies HTML by default.</p>","excerpt":"Tutorials for deploying on different static site hosts S3/Cloudfront GitHub Pages GitLab Pages Heroku Amazon S3 and Cloudfront If you decide…","timeToRead":7,"frontmatter":{"title":"Deploying Gatsby"},"parent":{"__typename":"File","relativePath":"docs/deploy-gatsby.md"}}},"pathContext":{"slug":"/docs/deploy-gatsby/"}}